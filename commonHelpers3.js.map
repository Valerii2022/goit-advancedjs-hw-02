{"version":3,"file":"commonHelpers3.js","sources":["../src/js/03-promises.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst refs = { form: document.querySelector('.form') };\n\nrefs.form.addEventListener('submit', handleFormSubmit);\n\nlet timerId = null;\nlet position = 0;\n\nfunction handleFormSubmit(e) {\n  e.preventDefault();\n  const formData = new FormData(e.currentTarget);\n  const data = {};\n  formData.forEach((value, key) => {\n    data[key] = value;\n  });\n  let delay = Number(data.delay);\n  const amount = Number(data.amount);\n  const step = Number(data.step);\n\n  setTimeout(() => {\n    position += 1;\n    createPromise(position, delay).then(onSuccess).catch(onError);\n\n    timerId = setInterval(() => {\n      position += 1;\n      delay += step;\n      createPromise(position, delay).then(onSuccess).catch(onError);\n\n      if (position === amount) {\n        clearInterval(timerId);\n        position = 0;\n      }\n    }, step);\n  }, delay);\n}\n\nfunction createPromise(position, delay) {\n  return new Promise((resolve, reject) => {\n    const shouldResolve = Math.random() > 0.5;\n    if (shouldResolve) {\n      resolve({ position, delay });\n    } else {\n      reject({ position, delay });\n    }\n  });\n}\n\nfunction onSuccess({ position, delay }) {\n  iziToast.success({\n    title: 'OK',\n    message: `Fulfilled promise ${position} in ${delay}ms`,\n    layout: 2,\n    position: 'topRight',\n    transitionIn: 'fadeInLeft',\n    transitionOut: 'fadeOutRight',\n  });\n}\n\nfunction onError({ position, delay }) {\n  iziToast.error({\n    title: 'Error',\n    message: `Rejected promise ${position} in ${delay}ms`,\n    layout: 2,\n    position: 'topRight',\n    transitionIn: 'fadeInLeft',\n    transitionOut: 'fadeOutRight',\n  });\n}\n"],"names":["refs","handleFormSubmit","timerId","position","e","formData","data","value","key","delay","amount","step","createPromise","onSuccess","onError","resolve","reject","iziToast"],"mappings":"wIAGA,MAAMA,EAAO,CAAE,KAAM,SAAS,cAAc,OAAO,CAAC,EAEpDA,EAAK,KAAK,iBAAiB,SAAUC,CAAgB,EAErD,IAAIC,EAAU,KACVC,EAAW,EAEf,SAASF,EAAiBG,EAAG,CAC3BA,EAAE,eAAc,EAChB,MAAMC,EAAW,IAAI,SAASD,EAAE,aAAa,EACvCE,EAAO,CAAA,EACbD,EAAS,QAAQ,CAACE,EAAOC,IAAQ,CAC/BF,EAAKE,GAAOD,CAChB,CAAG,EACD,IAAIE,EAAQ,OAAOH,EAAK,KAAK,EAC7B,MAAMI,EAAS,OAAOJ,EAAK,MAAM,EAC3BK,EAAO,OAAOL,EAAK,IAAI,EAE7B,WAAW,IAAM,CACfH,GAAY,EACZS,EAAcT,EAAUM,CAAK,EAAE,KAAKI,CAAS,EAAE,MAAMC,CAAO,EAE5DZ,EAAU,YAAY,IAAM,CAC1BC,GAAY,EACZM,GAASE,EACTC,EAAcT,EAAUM,CAAK,EAAE,KAAKI,CAAS,EAAE,MAAMC,CAAO,EAExDX,IAAaO,IACf,cAAcR,CAAO,EACrBC,EAAW,EAEd,EAAEQ,CAAI,CACR,EAAEF,CAAK,CACV,CAEA,SAASG,EAAcT,EAAUM,EAAO,CACtC,OAAO,IAAI,QAAQ,CAACM,EAASC,IAAW,CAChB,KAAK,OAAM,EAAK,GAEpCD,EAAQ,CAAE,SAAAZ,EAAU,MAAAM,CAAK,CAAE,EAE3BO,EAAO,CAAE,SAAAb,EAAU,MAAAM,CAAK,CAAE,CAEhC,CAAG,CACH,CAEA,SAASI,EAAU,CAAE,SAAAV,EAAU,MAAAM,GAAS,CACtCQ,EAAS,QAAQ,CACf,MAAO,KACP,QAAS,qBAAqBd,QAAeM,MAC7C,OAAQ,EACR,SAAU,WACV,aAAc,aACd,cAAe,cACnB,CAAG,CACH,CAEA,SAASK,EAAQ,CAAE,SAAAX,EAAU,MAAAM,GAAS,CACpCQ,EAAS,MAAM,CACb,MAAO,QACP,QAAS,oBAAoBd,QAAeM,MAC5C,OAAQ,EACR,SAAU,WACV,aAAc,aACd,cAAe,cACnB,CAAG,CACH"}